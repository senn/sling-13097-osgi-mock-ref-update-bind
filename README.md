# SLING-13097: OSGi Mock Reference Update Bind Issue

(Autogenerated by Copilot)

This project is a reproducer for [SLING-13097](https://issues.apache.org/jira/browse/SLING-13097), demonstrating an issue with Apache Sling OSGi Mock where the `@Reference` annotation with custom `bind`/`unbind`/`updated` methods does not properly inject services.

## Problem Description

When using OSGi Declarative Services with custom bind methods:

```java
@Reference(
    cardinality = ReferenceCardinality.MULTIPLE,
    policy = ReferencePolicy.DYNAMIC,
    policyOption = ReferencePolicyOption.GREEDY,
    bind = "onRefComponentBindingChange",
    unbind = "onRefComponentBindingChange",
    updated = "onRefComponentBindingChange"
)
private volatile Collection<RefComponent> refComponents;
```

The `refComponents` field remains `null` in OSGi Mock, while it is properly injected in a real OSGi container.

## Project Structure

- **`BindingComponent`** - A component that uses custom `bind`/`unbind`/`updated` methods for reference injection
- **`NonBindingComponent`** - A component that uses the default reference binding (no custom methods)
- **`RefComponent`** - A factory component that is referenced by the above components

## Requirements

- Java 17+
- Maven 3.6+

## Building

```bash
mvn clean install
```

## Running Tests

```bash
mvn test
```

The `BindingComponentTest` demonstrates the issue - it will fail because `refComponents` is `null` when using custom bind methods, whereas `NonBindingComponentTest` passes with default binding.

## Related

- [SLING-13097](https://issues.apache.org/jira/browse/SLING-13097) - Apache Sling JIRA issue
- [Apache Sling OSGi Mock](https://sling.apache.org/documentation/development/osgi-mock.html)
